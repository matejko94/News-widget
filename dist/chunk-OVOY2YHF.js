import{a as F}from"./chunk-X6XSKBAX.js";import{$a as Q,B as H,D as ce,Ea as Me,Fa as O,Ga as ze,Ha as V,I as de,Ia as K,Ja as l,K as S,Ka as g,L as pe,La as c,M as $,Ma as we,N as W,Na as be,O as N,Oa as Ce,Pa as Ie,Q as ee,Qa as ke,Ra as te,Sa as ie,Ta as v,Ua as q,V as I,Va as ne,Wa as M,X as _,Xa as se,Y as y,Ya as d,Z as ue,Za as z,_a as De,a as x,b as T,ca as G,da as me,h as re,ha as f,hb as ae,ia as U,ib as Oe,ja as k,k as le,l as b,m as P,na as _e,o as R,qa as fe,qb as J,ra as ye,rb as Le,s as C,sb as Ee,t as he,ta as u,ua as D,ub as xe,x as ge,xa as ve,xb as Pe,y as Z,yb as Y,za as A}from"./chunk-ZK4N3I6M.js";var $e=400,We=1,Se=1,Ae=(()=>{let n=class n{get calculatedWidth(){let e=this.config.width||this.width||We;return this.el.nativeElement.parentNode.offsetWidth>0&&e<=1&&e>0&&(e=this.el.nativeElement.parentNode.offsetWidth*e),e}get calculatedHeight(){let e=this.config.height||this.height||$e;return this.el.nativeElement.parentNode.offsetHeight>0&&e<=1&&e>0&&(e=this.el.nativeElement.parentNode.offsetHeight*e),e}constructor(e,t){this.el=e,this.r2=t,this.data=[],this.config={},this.clicked=new k,this.dataChanges=new k,this.afterInit=new k,this.afterChecked=new k,this.cloudDataHtmlElements=[],this.dataArr=[]}onResize(e){this.logMessage("debug","rezisze triggered"),window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.options.realignOnResize&&this.reDraw()},200)}ngOnChanges(e){this.logMessage("debug","ngOnChanges fired",e),this.config=x({width:500,height:300,overflow:!0,strict:!1,zoomOnHover:{transitionTime:0,scale:1,delay:0},realignOnResize:!1,randomizeAngle:!1,step:2,log:!1},this.config),this.width&&(this.config.width=this.width),this.height&&(this.config.height=this.height),typeof this.overflow=="boolean"&&(this.config.overflow=this.overflow),typeof this.strict=="boolean"&&(this.config.strict=this.strict),typeof this.realignOnResize=="boolean"&&(this.config.realignOnResize=this.realignOnResize),typeof this.randomizeAngle=="boolean"&&(this.config.randomizeAngle=this.randomizeAngle),typeof this.background=="string"&&(this.config.background=this.background),typeof this.font=="string"&&(this.config.font=this.font),this.zoomOnHover&&(this.config.zoomOnHover=this.zoomOnHover),this.step&&(this.config.step=this.step),this.log&&(this.config.log=this.log),this.delay&&(this.config.delay=this.delay),this.logMessage("warn","cloud configuration",this.config),this.config.font&&this.r2.setStyle(this.el.nativeElement,"font",this.config.font),this.config.background&&this.r2.setStyle(this.el.nativeElement,"background",this.config.background),this.reDraw(e)}ngAfterContentInit(){this.afterInit?.emit(),this.logMessage("debug","afterInit emitted")}ngAfterContentChecked(){this.afterChecked?.emit(),this.logMessage("debug","afterChecked emitted")}reDraw(e){if(this.dataChanges?.emit(e),this.afterChecked?.emit(),this.logMessage("debug","dataChanges emitted"),this.cloudDataHtmlElements=[],!this.data){console.error("angular-tag-cloud: No data passed. Please pass an Array of CloudData");return}this.el.nativeElement.innerHTML="",e&&e.data&&(this.dataArr=e.data.currentValue),this.options=T(x({},this.config),{aspectRatio:this.calculatedWidth/this.calculatedHeight,width:this.calculatedWidth,height:this.calculatedHeight,center:{x:this.calculatedWidth/2,y:this.calculatedHeight/2}}),this.r2.setStyle(this.el.nativeElement,"width",this.options.width+"px"),this.r2.setStyle(this.el.nativeElement,"height",this.options.height+"px"),this.drawWordCloud(),this.logMessage("debug","reDraw finished")}descriptiveEntry(e){let t=e.text;return t+=e.color?`-${e.color}`:"",t+=e.external?`-${e.external}`:"",t+=e.link?`-${e.link}`:"",t+=e.rotate?`-${e.rotate}`:"",t}drawWordCloud(){this.dataArr.sort((i,a)=>this.descriptiveEntry(i).localeCompare(this.descriptiveEntry(a))),this.dataArr.sort((i,a)=>a.weight-i.weight);let e=this.dataArr.filter(i=>i.position),t=this.dataArr.filter(i=>!i.position);e.forEach((i,a)=>{this.drawWord(a,i)}),t.forEach((i,a)=>{this.drawWord(a,i)})}hitTest(e){for(let t of this.cloudDataHtmlElements)if(this.overlapping(e,t))return!0;return!1}overlapping(e,t){let{offsetLeft:i,offsetTop:a,offsetWidth:o,offsetHeight:h}=t,m=i+o,w=a+h;return!(e.right<i||e.left>m||e.bottom<a||e.top>w)}getWeightForWord(e){let t=5;return this.dataArr[0].weight>this.dataArr[this.dataArr.length-1].weight&&(this.options.strict?e.weight>10?(t=10,this.logMessage("warn",`[TagCloud strict] Weight property ${e.weight} > 10. Fallback to 10 as you are using strict mode`,e)):e.weight<1?(t=1,this.logMessage("warn",`[TagCloud strict] Given weight property ${e.weight} < 1. Fallback to 1 as you are using strict mode`,e)):e.weight%1!==0?(t=Math.round(e.weight),this.logMessage("warn",`[TagCloud strict] Given weight property ${e.weight} is not an integer. Rounded value to ${t}`,e)):t=e.weight:t=Math.round((e.weight-this.dataArr[this.dataArr.length-1].weight)/(this.dataArr[0].weight-this.dataArr[this.dataArr.length-1].weight)*9)+1),t}setWordColor(e,t){this.r2.setStyle(e,"color",t)}setTooltip(e,t){this.r2.addClass(e,"tooltip");let i=this.r2.createElement("span");i.className="tooltiptext";let a=this.r2.createText(t);i.appendChild(a),e.appendChild(i)}setWordRotation(e,t){let i=t?`rotate(${t}deg)`:"";return this.r2.setStyle(e,"transform",i),i}wrapNodeIntoAnchorElement(e,t){let i=this.r2.createElement("a");return i.href=t.link||"",t.external!==void 0&&t.external&&(i.target="_blank"),i.appendChild(e),i}applyZoomStyle(e,t,i,a){this.options.zoomOnHover&&this.options.zoomOnHover.scale!==1&&(this.options.zoomOnHover.transitionTime||(this.options.zoomOnHover.transitionTime=0),this.options.zoomOnHover.scale||(this.options.zoomOnHover.scale=1),t.onmouseover=()=>{this.options.zoomOnHover?.transitionTime&&this.r2.setStyle(t,"transition",`transform ${this.options.zoomOnHover.transitionTime}s`),this.options.zoomOnHover?.scale&&this.r2.setStyle(t,"transform",`scale(${this.options.zoomOnHover.scale}) ${a}`),this.options.zoomOnHover?.delay&&this.r2.setStyle(t,"transition-delay",`${this.options.zoomOnHover.delay}s`),this.options.zoomOnHover?.color&&(i?this.r2.setStyle(e,"color",this.options.zoomOnHover.color):this.r2.setStyle(t,"color",this.options.zoomOnHover.color))},t.onmouseout=()=>{this.r2.setStyle(t,"transform",`none ${a}`),this.options.zoomOnHover?.color&&(i?this.r2.removeStyle(e,"color"):this.r2.removeStyle(t,"color"))})}setPosition(e,t,i){let a=this.options.randomizeAngle?6.28*Math.random():0,o=0,h=e.style;h.position="absolute";let m=!!(t.position&&t.position.left&&t.position.top),w=e.offsetWidth,E=e.offsetHeight,p=m&&t.position?.left?t.position.left:this.options.center.x-w/2,L=m&&t.position?.top?t.position.top:this.options.center.y-E/2;if(h.left=p+"px",h.top=L+"px",this.options.delay&&(e.classList.add("tag-animation-delay"),h.setProperty("--tag-animation-delay",`${this.options.delay*i}ms`)),!m)if(i===0)h.left=p+(Math.random()-.5)*2*(this.calculatedWidth/5)+"px",h.top=L+(Math.random()-.5)*2*(this.calculatedHeight/5)+"30px";else{for(;this.options.width&&this.options.height&&e.offsetHeight&&e.offsetWidth&&this.hitTest(new DOMRect(p,L,e.offsetWidth,e.offsetHeight));)o+=this.options.step||Se,a+=(i%2===0?1:-1)*(this.options.step||Se),p=this.options.center.x-w/2+o*Math.cos(a)*this.options.aspectRatio,L=this.options.center.y+o*Math.sin(a)-E/2;h.left=p+"px",h.top=L+"px"}if(!this.options.overflow&&(p<0||L<0||p+w>this.calculatedWidth||L+E>this.calculatedHeight)){this.logMessage("warn","Word did not fit into the cloud and overflow is set to 'false'. The element will be removed",e),e.remove();return}}drawWord(e,t){let i,a=this.getWeightForWord(t);i=this.r2.createElement("span"),i.className=`w${a}`,i.onclick=()=>{this.clicked?.emit(t)},i.onmouseenter=()=>{i.style.zIndex="2"},i.onmouseleave=()=>{i.style.zIndex="1"};let o=this.r2.createText(t.text);t.color&&this.setWordColor(i,t.color);let h=this.setWordRotation(i,t.rotate);t.link&&(o=this.wrapNodeIntoAnchorElement(o,t)),this.options.zoomOnHover&&this.options.zoomOnHover.scale!==1&&this.applyZoomStyle(o,i,t.link,h),i.appendChild(o),this.r2.appendChild(this.el.nativeElement,i),t.tooltip&&this.setTooltip(i,t.tooltip),i.id=`angular-tag-cloud-item-${e}`,this.setPosition(i,t,e),this.logMessage("debug","Adds new word <span>",i),this.cloudDataHtmlElements.push(i),this.logMessage("debug","Placed words",this.cloudDataHtmlElements)}logMessage(e,...t){this.config&&(this.config.log==="debug"?console.log(`[AngularTagCloudModule ${e}]`,...t):this.config.log==="warn"&&e==="warn"&&console.warn(`[AngularTagCloudModule ${e}]`,...t))}};n.\u0275fac=function(t){return new(t||n)(D(U),D(ve))},n.\u0275cmp=y({type:n,selectors:[["angular-tag-cloud"],["ng-tag-cloud"],["ngtc"]],hostBindings:function(t,i){t&1&&we("resize",function(o){return i.onResize(o)},!1,ye)},inputs:{data:"data",width:"width",height:"height",step:"step",overflow:"overflow",strict:"strict",zoomOnHover:"zoomOnHover",realignOnResize:"realignOnResize",randomizeAngle:"randomizeAngle",background:"background",font:"font",delay:"delay",config:"config",log:"log"},outputs:{clicked:"clicked",dataChanges:"dataChanges",afterInit:"afterInit",afterChecked:"afterChecked"},standalone:!0,features:[G,M],decls:0,vars:0,template:function(t,i){},styles:['[_nghost-%COMP%]{font-family:Helvetica,Arial,sans-serif;font-size:10px;line-height:normal;color:#09f;overflow:hidden;position:relative;display:block}.tag-animation-delay[_ngcontent-%COMP%]{--tag-animation-delay: .5s;animation:_ngcontent-%COMP%_fadeIn .5s;opacity:0;animation-fill-mode:forwards;animation-delay:var(--tag-animation-delay)}span[_ngcontent-%COMP%]{padding:0}span.w10[_ngcontent-%COMP%]{font-size:550%}span.w9[_ngcontent-%COMP%]{font-size:500%}span.w8[_ngcontent-%COMP%]{font-size:450%}span.w7[_ngcontent-%COMP%]{font-size:400%}span.w6[_ngcontent-%COMP%]{font-size:350%}span.w5[_ngcontent-%COMP%]{font-size:300%}span.w4[_ngcontent-%COMP%]{font-size:250%}span.w3[_ngcontent-%COMP%]{font-size:200%}span.w2[_ngcontent-%COMP%]{font-size:150%}span.w1[_ngcontent-%COMP%]{font-size:100%}a[_ngcontent-%COMP%]:hover{color:#0df}a[_ngcontent-%COMP%]:hover, span.w10[_ngcontent-%COMP%], span.w9[_ngcontent-%COMP%], span.w8[_ngcontent-%COMP%]{color:#0cf}span.w7[_ngcontent-%COMP%]{color:#39d}span.w6[_ngcontent-%COMP%]{color:#90c5f0}span.w5[_ngcontent-%COMP%]{color:#90a0dd}span.w4[_ngcontent-%COMP%]{color:#90c5f0}span.w3[_ngcontent-%COMP%]{color:#a0ddff}span.w2[_ngcontent-%COMP%]{color:#9ce}span.w1[_ngcontent-%COMP%]{color:#aab5f0}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]{visibility:hidden;width:inherit;background-color:#555;color:#fff;text-align:center;border-radius:6px;padding:5px 10px;position:absolute;bottom:100%;left:0;opacity:0;transition:opacity .3s}.tooltip[_ngcontent-%COMP%]   .tooltiptext[_ngcontent-%COMP%]:after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#555 transparent transparent transparent}.tooltip[_ngcontent-%COMP%]:hover   .tooltiptext[_ngcontent-%COMP%]{visibility:visible;opacity:1}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}']});let s=n;return s})();var Ne=["triangle"],Fe=(()=>{let n=class n{constructor(){this.value=f.required(),Oe(()=>{this.el&&(this.el.nativeElement.style.transformOrigin="10px 162px",this.el.nativeElement.style.transform=`rotate(${(this.value()??0)*90}deg)`)})}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=y({type:n,selectors:[["app-sentiment-meter"]],viewQuery:function(t,i){if(t&1&&ke(Ne,5),t&2){let a;te(a=ie())&&(i.el=a.first)}},inputs:{value:[_.SignalBased,"value"]},standalone:!0,features:[M],decls:17,vars:0,consts:[["triangle",""],["height","177px","viewBox","0 0 385 185","version","1.1","xmlns","http://www.w3.org/2000/svg"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["id","Artboard","transform","translate(-15.000000, -224.000000)"],["id","Group","transform","translate(15.000000, 220.000000)"],["id","guage"],["d","M84.8041871,178.856781 L84.8041871,179.169281 L25,179.169281 L25,178.669281 C25,119.519295 57.1931907,67.8894771 105.011512,40.3501901 L135,92.2989954 C105.009619,109.483749 84.8041871,141.810321 84.8041871,178.856781 Z","id","red","fill","#BD3632"],["d","M235.050803,92.4864742 C205.21439,75.1028089 167.169843,73.7652453 135.133157,92.2884751 L134.862916,92.4447251 L105,40.6455806 L105.432385,40.3955806 C156.58355,10.8205878 217.307001,12.8896752 265,40.5376689 L235.050803,92.4864742 L235.050803,92.4864742 Z","id","yellow","fill","#EEAF30"],["d","M235,92.2989954 L264.988488,40.3501901 C312.806809,67.8894771 345,119.519295 345,178.669281 L345,179.169281 L285.195813,179.169281 L285.195813,178.856781 C285.195813,141.810321 264.990381,109.483749 235,92.2989954 L235,92.2989954 Z","id","green","fill","#008542"],["xmlns","http://www.w3.org/2000/svg","x","280","y","95","fill","white","height","36","width","36","viewBox","0 0 512 512"],["d","M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm177.6 62.1C192.8 334.5 218.8 352 256 352s63.2-17.5 78.4-33.9c9-9.7 24.2-10.4 33.9-1.4s10.4 24.2 1.4 33.9c-22 23.8-60 49.4-113.6 49.4s-91.7-25.5-113.6-49.4c-9-9.7-8.4-24.9 1.4-33.9s24.9-8.4 33.9 1.4zM144.4 208a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm192-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"],["xmlns","http://www.w3.org/2000/svg","x","170","y","30","fill","white","height","36","width","36","viewBox","0 0 512 512"],["d","M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM256 0a256 256 0 1 0 0 512A256 256 0 1 0 256 0zM176.4 240a32 32 0 1 0 0-64 32 32 0 1 0 0 64zm192-32a32 32 0 1 0 -64 0 32 32 0 1 0 64 0zM184 328c-13.3 0-24 10.7-24 24s10.7 24 24 24H328c13.3 0 24-10.7 24-24s-10.7-24-24-24H184z"],["xmlns","http://www.w3.org/2000/svg","x","55","y","95","fill","white","height","36","width","36","viewBox","0 0 512 512"],["d","M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zM174.6 384.1c-4.5 12.5-18.2 18.9-30.7 14.4s-18.9-18.2-14.4-30.7C146.9 319.4 198.9 288 256 288s109.1 31.4 126.6 79.9c4.5 12.5-2 26.2-14.4 30.7s-26.2-2-30.7-14.4C328.2 358.5 297.2 336 256 336s-72.2 22.5-81.4 48.1zM144.4 208a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm192-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"],["id","needle","transform","translate(175.000000, 18.000000)"],["fill","#3C3C3B","transform","rotate(90, 10, 162)","points","10 0 15 162 5 162",2,"transition","all 500ms ease"]],template:function(t,i){t&1&&(me(),l(0,"svg",1)(1,"g",2)(2,"g",3)(3,"g",4)(4,"g",5),c(5,"path",6)(6,"path",7)(7,"path",8),l(8,"svg",9),c(9,"path",10),g(),l(10,"svg",11),c(11,"path",12),g(),l(12,"svg",13),c(13,"path",14),g()(),l(14,"g",15),c(15,"polygon",16,0),g()()()()())},encapsulation:2,changeDetection:0});let s=n;return s})();var Ge=["*"],X=class{_clearListeners(){for(let n of this._listeners)n.remove();this._listeners=[]}constructor(n){this._ngZone=n,this._pending=[],this._listeners=[],this._targetStream=new b(void 0)}getLazyEmitter(n){return this._targetStream.pipe($(r=>{let e=new re(t=>{if(!r){this._pending.push({observable:e,observer:t});return}let i=r.addListener(n,a=>{this._ngZone.run(()=>t.next(a))});if(!i){t.complete();return}return this._listeners.push(i),()=>i.remove()});return e}))}setTarget(n){let r=this._targetStream.value;n!==r&&(r&&(this._clearListeners(),this._pending=[]),this._targetStream.next(n),this._pending.forEach(e=>e.observable.subscribe(e.observer)),this._pending=[])}destroy(){this._clearListeners(),this._pending=[],this._targetStream.complete()}},j={center:{lat:37.421995,lng:-122.084092},zoom:17,mapTypeId:"roadmap"},Te="500px",Re="500px",oe=(()=>{let n=class n{set center(e){this._center=e}set zoom(e){this._zoom=e}set options(e){this._options=e||j}constructor(e,t,i){if(this._elementRef=e,this._ngZone=t,this._eventManager=new X(I(A)),this.height=Te,this.width=Re,this._options=j,this.mapInitialized=new k,this.authFailure=new k,this.boundsChanged=this._eventManager.getLazyEmitter("bounds_changed"),this.centerChanged=this._eventManager.getLazyEmitter("center_changed"),this.mapClick=this._eventManager.getLazyEmitter("click"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.headingChanged=this._eventManager.getLazyEmitter("heading_changed"),this.idle=this._eventManager.getLazyEmitter("idle"),this.maptypeidChanged=this._eventManager.getLazyEmitter("maptypeid_changed"),this.mapMousemove=this._eventManager.getLazyEmitter("mousemove"),this.mapMouseout=this._eventManager.getLazyEmitter("mouseout"),this.mapMouseover=this._eventManager.getLazyEmitter("mouseover"),this.projectionChanged=this._eventManager.getLazyEmitter("projection_changed"),this.mapRightclick=this._eventManager.getLazyEmitter("rightclick"),this.tilesloaded=this._eventManager.getLazyEmitter("tilesloaded"),this.tiltChanged=this._eventManager.getLazyEmitter("tilt_changed"),this.zoomChanged=this._eventManager.getLazyEmitter("zoom_changed"),this._isBrowser=xe(i),this._isBrowser){let a=window;a.google,this._existingAuthFailureCallback=a.gm_authFailure,a.gm_authFailure=()=>{this._existingAuthFailureCallback&&this._existingAuthFailureCallback(),this.authFailure.emit()}}}ngOnChanges(e){(e.height||e.width)&&this._setSize();let t=this.googleMap;t&&(e.options&&t.setOptions(this._combineOptions()),e.center&&this._center&&t.setCenter(this._center),e.zoom&&this._zoom!=null&&t.setZoom(this._zoom),e.mapTypeId&&this.mapTypeId&&t.setMapTypeId(this.mapTypeId))}ngOnInit(){this._isBrowser&&(this._mapEl=this._elementRef.nativeElement.querySelector(".map-container"),this._setSize(),google.maps.Map?this._initialize(google.maps.Map):this._ngZone.runOutsideAngular(()=>{google.maps.importLibrary("maps").then(e=>this._initialize(e.Map))}))}_initialize(e){this._ngZone.runOutsideAngular(()=>{this.googleMap=new e(this._mapEl,this._combineOptions()),this._eventManager.setTarget(this.googleMap),this.mapInitialized.emit(this.googleMap)})}ngOnDestroy(){if(this.mapInitialized.complete(),this._eventManager.destroy(),this._isBrowser){let e=window;e.gm_authFailure=this._existingAuthFailureCallback}}fitBounds(e,t){this._assertInitialized(),this.googleMap.fitBounds(e,t)}panBy(e,t){this._assertInitialized(),this.googleMap.panBy(e,t)}panTo(e){this._assertInitialized(),this.googleMap.panTo(e)}panToBounds(e,t){this._assertInitialized(),this.googleMap.panToBounds(e,t)}getBounds(){return this._assertInitialized(),this.googleMap.getBounds()||null}getCenter(){return this._assertInitialized(),this.googleMap.getCenter()}getClickableIcons(){return this._assertInitialized(),this.googleMap.getClickableIcons()}getHeading(){return this._assertInitialized(),this.googleMap.getHeading()}getMapTypeId(){return this._assertInitialized(),this.googleMap.getMapTypeId()}getProjection(){return this._assertInitialized(),this.googleMap.getProjection()||null}getStreetView(){return this._assertInitialized(),this.googleMap.getStreetView()}getTilt(){return this._assertInitialized(),this.googleMap.getTilt()}getZoom(){return this._assertInitialized(),this.googleMap.getZoom()}get controls(){return this._assertInitialized(),this.googleMap.controls}get data(){return this._assertInitialized(),this.googleMap.data}get mapTypes(){return this._assertInitialized(),this.googleMap.mapTypes}get overlayMapTypes(){return this._assertInitialized(),this.googleMap.overlayMapTypes}_resolveMap(){return this.googleMap?Promise.resolve(this.googleMap):this.mapInitialized.pipe(H(1)).toPromise()}_setSize(){if(this._mapEl){let e=this._mapEl.style;e.height=this.height===null?"":Ze(this.height)||Te,e.width=this.width===null?"":Ze(this.width)||Re}}_combineOptions(){let e=this._options||{};return T(x({},e),{center:this._center||e.center||j.center,zoom:this._zoom??e.zoom??j.zoom,mapTypeId:this.mapTypeId||e.mapTypeId||j.mapTypeId,mapId:this.mapId||e.mapId})}_assertInitialized(){this.googleMap}};n.\u0275fac=function(t){return new(t||n)(D(U),D(A),D(_e))},n.\u0275cmp=y({type:n,selectors:[["google-map"]],inputs:{height:"height",width:"width",mapId:"mapId",mapTypeId:"mapTypeId",center:"center",zoom:"zoom",options:"options"},outputs:{mapInitialized:"mapInitialized",authFailure:"authFailure",boundsChanged:"boundsChanged",centerChanged:"centerChanged",mapClick:"mapClick",mapDblclick:"mapDblclick",mapDrag:"mapDrag",mapDragend:"mapDragend",mapDragstart:"mapDragstart",headingChanged:"headingChanged",idle:"idle",maptypeidChanged:"maptypeidChanged",mapMousemove:"mapMousemove",mapMouseout:"mapMouseout",mapMouseover:"mapMouseover",projectionChanged:"projectionChanged",mapRightclick:"mapRightclick",tilesloaded:"tilesloaded",tiltChanged:"tiltChanged",zoomChanged:"zoomChanged"},exportAs:["googleMap"],standalone:!0,features:[G,M],ngContentSelectors:Ge,decls:2,vars:0,consts:[[1,"map-container"]],template:function(t,i){t&1&&(Ce(),c(0,"div",0),Ie(1))},encapsulation:2,changeDetection:0});let s=n;return s})(),Ue=/([A-Za-z%]+)$/;function Ze(s){return s==null?"":Ue.test(s)?s:`${s}px`}var He=(()=>{let n=class n{set options(e){this._options.next(e||{})}set center(e){this._center.next(e)}set radius(e){this._radius.next(e)}constructor(e,t){this._map=e,this._ngZone=t,this._eventManager=new X(I(A)),this._options=new b({}),this._center=new b(void 0),this._radius=new b(void 0),this._destroyed=new le,this.centerChanged=this._eventManager.getLazyEmitter("center_changed"),this.circleClick=this._eventManager.getLazyEmitter("click"),this.circleDblclick=this._eventManager.getLazyEmitter("dblclick"),this.circleDrag=this._eventManager.getLazyEmitter("drag"),this.circleDragend=this._eventManager.getLazyEmitter("dragend"),this.circleDragstart=this._eventManager.getLazyEmitter("dragstart"),this.circleMousedown=this._eventManager.getLazyEmitter("mousedown"),this.circleMousemove=this._eventManager.getLazyEmitter("mousemove"),this.circleMouseout=this._eventManager.getLazyEmitter("mouseout"),this.circleMouseover=this._eventManager.getLazyEmitter("mouseover"),this.circleMouseup=this._eventManager.getLazyEmitter("mouseup"),this.radiusChanged=this._eventManager.getLazyEmitter("radius_changed"),this.circleRightclick=this._eventManager.getLazyEmitter("rightclick"),this.circleInitialized=new k}ngOnInit(){this._map._isBrowser&&this._combineOptions().pipe(H(1)).subscribe(e=>{google.maps.Circle&&this._map.googleMap?this._initialize(this._map.googleMap,google.maps.Circle,e):this._ngZone.runOutsideAngular(()=>{Promise.all([this._map._resolveMap(),google.maps.importLibrary("maps")]).then(([t,i])=>{this._initialize(t,i.Circle,e)})})})}_initialize(e,t,i){this._ngZone.runOutsideAngular(()=>{this.circle=new t(i),this._assertInitialized(),this.circle.setMap(e),this._eventManager.setTarget(this.circle),this.circleInitialized.emit(this.circle),this._watchForOptionsChanges(),this._watchForCenterChanges(),this._watchForRadiusChanges()})}ngOnDestroy(){this._eventManager.destroy(),this._destroyed.next(),this._destroyed.complete(),this.circle?.setMap(null)}getBounds(){return this._assertInitialized(),this.circle.getBounds()}getCenter(){return this._assertInitialized(),this.circle.getCenter()}getDraggable(){return this._assertInitialized(),this.circle.getDraggable()}getEditable(){return this._assertInitialized(),this.circle.getEditable()}getRadius(){return this._assertInitialized(),this.circle.getRadius()}getVisible(){return this._assertInitialized(),this.circle.getVisible()}_combineOptions(){return he([this._options,this._center,this._radius]).pipe(C(([e,t,i])=>T(x({},e),{center:t||e.center,radius:i!==void 0?i:e.radius})))}_watchForOptionsChanges(){this._options.pipe(W(this._destroyed)).subscribe(e=>{this._assertInitialized(),this.circle.setOptions(e)})}_watchForCenterChanges(){this._center.pipe(W(this._destroyed)).subscribe(e=>{e&&(this._assertInitialized(),this.circle.setCenter(e))})}_watchForRadiusChanges(){this._radius.pipe(W(this._destroyed)).subscribe(e=>{e!==void 0&&(this._assertInitialized(),this.circle.setRadius(e))})}_assertInitialized(){}};n.\u0275fac=function(t){return new(t||n)(D(oe),D(A))},n.\u0275dir=ue({type:n,selectors:[["map-circle"]],inputs:{options:"options",center:"center",radius:"radius"},outputs:{centerChanged:"centerChanged",circleClick:"circleClick",circleDblclick:"circleDblclick",circleDrag:"circleDrag",circleDragend:"circleDragend",circleDragstart:"circleDragstart",circleMousedown:"circleMousedown",circleMousemove:"circleMousemove",circleMouseout:"circleMouseout",circleMouseover:"circleMouseover",circleMouseup:"circleMouseup",radiusChanged:"radiusChanged",circleRightclick:"circleRightclick",circleInitialized:"circleInitialized"},exportAs:["mapCircle"],standalone:!0});let s=n;return s})();var Ve=(s,n)=>n.country;function Ke(s,n){if(s&1&&c(0,"map-circle",1),s&2){let r=n.$implicit;O("center",r.c)("title",r.country)("options",r.options)}}function qe(s,n){if(s&1&&(l(0,"google-map",0),V(1,Ke,1,3,"map-circle",1,Ve),g()),s&2){let r=be();O("height",r.mapHeight())("zoom",r.zoom())("center",r.location())("options",r.mapOptions()),u(),K(r.markerPositions())}}var Be=(()=>{let n=class n{constructor(){this.http=I(Y),this.newsItems=f.required(),this.mapHeight=f.required(),this.mapCircleRadiusFactor=f.required(),this.zoom=f.required(),this.location=f.required(),this.mapOptions=ae(()=>this.createMapOptions(this.zoom())),this.markerPositions=ae(()=>this.createMarkerPositions(this.newsItems(),this.mapCircleRadiusFactor())),this.mapInitialized$=P}ngOnInit(){this.mapInitialized$=this.initializeMap()}createMapOptions(e){return{disableDefaultUI:!0,minZoom:e,restriction:{latLngBounds:{north:85,south:-85,west:-180,east:180}},styles:[{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{lightness:17}]}]}}initializeMap(){return this.http.jsonp(`https://maps.googleapis.com/maps/api/js?key=${F.api.googleMaps.apiKey}`,"callback").pipe(H(1),C(()=>!0),Z(e=>(console.error("failed to initialize google maps",e),R(!1))))}createMarkerPositions(e,t){let i=e?.length??0,a=new Map;return e?.filter(o=>o._source.source.location?.country).forEach(o=>{let h=o._source.source.location.country?.label?.eng,m=o._source.sentiment??0,{lat:w,long:E}=o._source.source.location.country;if(a.has(h)){let p=a.get(h);a.set(h,{count:p.count+1,location:p.location,sentiment:(p.sentiment*p.count+m)/(p.count+1)})}else a.set(h,{count:1,location:{lat:w,lng:E},sentiment:m})}),[...a.entries()].map(([o,{location:h,sentiment:m,count:w}])=>({country:o,c:h,options:{fillColor:this.getColorForValue(m),radius:5e6*t*(w/i),strokeWeight:2,fillOpacity:.6,strokeColor:this.getColorForValue(m)}}))}getColorForValue(e){return`hsl(${(e+1)/2*120}, 100%, 50%)`}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=y({type:n,selectors:[["app-heatmap"]],inputs:{newsItems:[_.SignalBased,"newsItems"],mapHeight:[_.SignalBased,"mapHeight"],mapCircleRadiusFactor:[_.SignalBased,"mapCircleRadiusFactor"],zoom:[_.SignalBased,"zoom"],location:[_.SignalBased,"location"]},standalone:!0,features:[M],decls:2,vars:3,consts:[["width","100%",3,"height","zoom","center","options"],[3,"center","title","options"]],template:function(t,i){t&1&&(Me(0,qe,3,4,"google-map",0),d(1,"async")),t&2&&ze(0,z(1,1,i.mapInitialized$)?0:-1)},dependencies:[J,oe,He],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%;aspect-ratio:16/8}  google-map .map-container{aspect-ratio:16/8}"],changeDetection:0});let s=n;return s})();var je=(()=>{let n=class n{constructor(){this.http=I(Y)}getCloudData(e){return this.http.get(`${F.api.cloudTag.url}?topicKey=${e}`).pipe(C(({keywordAggr:t})=>t.results.map(i=>({text:i.keyword,weight:i.weight*1e3}))),S(1),Z(t=>(console.error("failed to fetch cloud data",t),R([]))))}getNews(e,t){return this.http.post(F.api.news.url,{size:1e4,query:{bool:{must:[{match:{"SDG.keyword":`SDG ${t}`}},{range:{dateTimePub:{gte:e.toISOString(),lt:new Date(new Date(e).setDate(e.getDate()+1)).toISOString()}}}]}}},{headers:new Pe({"Content-Type":"application/json",Authorization:"Basic "+F.api.news.auth})}).pipe(C(i=>i.hits.hits),Z(i=>(console.error("failed to fetch data",i),R([]))),S(1))}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=ee({token:n,factory:n.\u0275fac,providedIn:"root"});let s=n;return s})();var Qe=(s,n)=>n._source.url,Je=()=>({lat:40,lng:0}),Ye=()=>[];function Xe(s,n){if(s&1&&(l(0,"div",3),d(1,"slice"),l(2,"a",10),v(3),d(4,"slice"),g(),l(5,"div",11),v(6),d(7,"date"),g()()),s&2){let r=n.$implicit;O("title",Q(1,4,r._source.body,0,100)+"..."),u(2),O("href",r._source.url,fe),u(),ne(" ",Q(4,8,r._source.title,0,40)," "),u(3),ne(" ",Q(7,12,r._source.dateTimePub,"EEE MMM d yyyy, HH:mm","UTC")," ")}}function et(s,n){s&1&&(l(0,"div",4),v(1," No news found "),g())}var ni=(()=>{let n=class n{constructor(){this.newsService=I(je),this.sdg=f.required(),this.topicKey=f.required(),this.shownDate$=new b(new Date),this.loadedDate$=new b(new Date),this.isLoading$=new b(!0),this.news$=P,this.cloudData$=P,this.sentimentAverage$=P}ngOnInit(){this.shownDate$.next(new Date),this.news$=this.setupNews(),this.cloudData$=this.newsService.getCloudData(this.topicKey()),this.sentimentAverage$=this.setupSentimentAverage(),this.startCounter()}setupNews(){return this.shownDate$.pipe(N(()=>this.isLoading$.next(!0)),$(e=>this.newsService.getNews(e,this.sdg())),N(()=>{this.loadedDate$.next(this.shownDate$.value),this.isLoading$.next(!1)}),S(1))}setupSentimentAverage(){return this.news$.pipe(C(e=>{let t=0,i=0;return e.forEach(a=>{a._source.sentiment!==null&&a._source.sentiment!==void 0&&(t++,i+=a._source.sentiment)}),Math.round(i/(t||1)*100)/100}),S(1))}startCounter(){return this.isLoading$.pipe(pe(!0),de(),ge(([e,t])=>e&&!t),ce(1500),N(()=>{let e=new Date(this.shownDate$.value);e>=this.minDate?this.shownDate$.next(new Date(e.setDate(e.getDate()-1))):this.shownDate$.next(new Date)})).subscribe()}get minDate(){return new Date(new Date().setDate(new Date().getDate()-31))}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=y({type:n,selectors:[["app-news"]],inputs:{sdg:[_.SignalBased,"sdg"],topicKey:[_.SignalBased,"topicKey"]},standalone:!0,features:[M],decls:30,vars:32,consts:[[3,"newsItems","zoom","mapHeight","location","mapCircleRadiusFactor"],[1,"grid","grid-cols-2","h-container"],[1,"overflow-y-auto","h-container"],[1,"border-b-2","my-3",3,"title"],[1,"flex","flex-col","justify-center","items-center","h-full","text-xl","font-semibold","text-gray-600"],[1,"overflow-hidden","flex","flex-col","items-center"],[1,"!w-full","m-auto",3,"realignOnResize","overflow","data"],[1,"pl-6",3,"value"],[1,"flex","justify-between","gap-4","ml-6","w-full"],[1,"text-lg"],[1,"font-semibold","text-lg","mb-2",3,"href"],[1,"text-gray-500","text-lg"]],template:function(t,i){if(t&1&&(c(0,"app-heatmap",0),d(1,"async"),l(2,"div",1)(3,"div",2),V(4,Xe,8,16,"div",3,Qe,!1,et,2,0,"div",4),d(7,"async"),g(),l(8,"div",5),c(9,"angular-tag-cloud",6),d(10,"async"),c(11,"app-sentiment-meter",7),d(12,"async"),l(13,"div",8)(14,"div",9)(15,"div"),v(16,"Showing: "),l(17,"b"),v(18),d(19,"async"),d(20,"date"),g()(),l(21,"div"),v(22," Total: "),l(23,"b"),v(24),d(25,"async"),g(),v(26," | Sentiment: "),l(27,"b"),v(28),d(29,"async"),g()()()()()()),t&2){let a,o;O("newsItems",z(1,13,i.news$))("zoom",2)("mapHeight","auto")("location",se(30,Je))("mapCircleRadiusFactor",1.5),u(4),K(z(7,15,i.news$)),u(5),O("realignOnResize",!0)("overflow",!1)("data",(a=z(10,17,i.cloudData$))!==null&&a!==void 0?a:se(31,Ye)),u(2),O("value",z(12,19,i.sentimentAverage$)),u(7),q(De(20,23,z(19,21,i.loadedDate$),"dd.MM.yyyy")),u(6),q((o=z(25,26,i.news$))==null?null:o.length),u(4),q(z(29,28,i.sentimentAverage$))}},dependencies:[Ae,Fe,J,Le,Ee,Be],styles:[".h-container[_ngcontent-%COMP%]{height:550px}"],changeDetection:0});let s=n;return s})();export{ni as default};
